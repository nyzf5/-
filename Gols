if not game:IsLoaded() then
    game.Loaded:Wait()
end

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Variáveis
local ativo = false
local torsoOriginal
local tamanhoHitbox = 15
local painelFrame

-- =========== FUNÇÃO HITBOX ===========
local function hitbox()
    local torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
    if not torso then return end

    if ativo then
        if not torsoOriginal then
            torsoOriginal = torso.Size
        end

        torso.Size = Vector3.new(tamanhoHitbox, tamanhoHitbox, tamanhoHitbox)
        torso.Transparency = 0.7
        torso.Color = Color3.fromRGB(255, 0, 0)

        torso.Touched:Connect(function(hit)
            if not ativo then return end
            local nome = hit.Name:lower()
            if nome:find("ball") or nome:find("bola") or nome:find("soccer") then
                local dir = (hit.Position - torso.Position).Unit * 100
                local bv = Instance.new("BodyVelocity")
                bv.Velocity = Vector3.new(dir.X, 40, dir.Z)
                bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
                bv.Parent = hit
                game:GetService("Debris"):AddItem(bv, 0.3)
            end
        end)
    else
        if torsoOriginal then
            torso.Size = torsoOriginal
            torso.Transparency = 0
            torso.Color = Color3.fromRGB(255,255,255)
        end
    end
end

-- =========== PAINEL ===========
local function criarPainel()
    local gui = Instance.new("ScreenGui", player.PlayerGui)
    gui.ResetOnSpawn = false

    painelFrame = Instance.new("Frame")
    painelFrame.Name = "Painel"
    painelFrame.Size = UDim2.new(0, 160, 0, 200) -- painel menor
    painelFrame.Position = UDim2.new(0, 20, 0.5, -120)
    painelFrame.BackgroundColor3 = Color3.fromRGB(0,0,0)
    painelFrame.BackgroundTransparency = 0.1
    painelFrame.BorderSizePixel = 0
    painelFrame.Parent = gui

    local corner = Instance.new("UICorner", painelFrame)
    corner.CornerRadius = UDim.new(0,10)

    local stroke = Instance.new("UIStroke", painelFrame)
    stroke.Color = Color3.fromRGB(255,255,255)
    stroke.Thickness = 3

    -- TÍTULO HITBOX (ÁREA DE ARRASTE)
    local titulo = Instance.new("TextLabel", painelFrame)
    titulo.Size = UDim2.new(1,0,0,40)
    titulo.Position = UDim2.new(0,0,0,10)
    titulo.Text = "HITBOX"
    titulo.TextScaled = true
    titulo.Font = Enum.Font.GothamBold
    titulo.TextColor3 = Color3.fromRGB(255,255,255)
    titulo.BackgroundTransparency = 1 -- sem cinza
    titulo.Active = true

    -- Linha
    local linha = Instance.new("Frame", painelFrame)
    linha.Size = UDim2.new(0.9, 0, 0, 2)
    linha.Position = UDim2.new(0.05, 0, 0, 55)
    linha.BackgroundColor3 = Color3.fromRGB(255,255,255)
    linha.BorderSizePixel = 0

    -- Crédito
    local credito = Instance.new("TextLabel", painelFrame)
    credito.Size = UDim2.new(1, 0, 0, 15)
    credito.Position = UDim2.new(0, 0, 0, 60)
    credito.Text = "feito por Nyz"
    credito.TextColor3 = Color3.fromRGB(200,200,200)
    credito.BackgroundTransparency = 1
    credito.TextSize = 12
    credito.Font = Enum.Font.Gotham

    -- Texto tamanho
    local textoSize = Instance.new("TextLabel", painelFrame)
    textoSize.Size = UDim2.new(1,0,0,30)
    textoSize.Position = UDim2.new(0,0,0,80)
    textoSize.Text = "Tamanho:"
    textoSize.TextColor3 = Color3.fromRGB(255,255,255)
    textoSize.BackgroundTransparency = 1
    textoSize.TextScaled = true
    textoSize.Font = Enum.Font.Gotham

    -- Caixa tamanho
    local caixaSize = Instance.new("TextBox", painelFrame)
    caixaSize.Size = UDim2.new(0.8,0,0,35)
    caixaSize.Position = UDim2.new(0.1,0,0,110)
    caixaSize.Text = ""
    caixaSize.PlaceholderText = "Recomendado 15"
    caixaSize.PlaceholderColor3 = Color3.fromRGB(170,170,170)
    caixaSize.TextColor3 = Color3.fromRGB(255,255,255)
    caixaSize.TextScaled = false
    caixaSize.TextSize = 14
    caixaSize.Font = Enum.Font.Gotham
    caixaSize.BackgroundColor3 = Color3.fromRGB(30,30,30)

    local c1 = Instance.new("UICorner", caixaSize)
    c1.CornerRadius = UDim.new(0,5)

    -- Botão
    local botao = Instance.new("TextButton", painelFrame)
    botao.Size = UDim2.new(0.8,0,0,40)
    botao.Position = UDim2.new(0.1,0,0,150)
    botao.Text = "DESATIVADO"
    botao.TextScaled = true
    botao.Font = Enum.Font.GothamBold
    botao.TextColor3 = Color3.fromRGB(255,255,255)
    botao.BackgroundColor3 = Color3.fromRGB(200,50,50)

    local c2 = Instance.new("UICorner", botao)
    c2.CornerRadius = UDim.new(0,8)

    -- =========== ARRASTE (SÓ NO HITBOX) ===========
    local dragging = false
    local dragStart
    local startPos

    local function update(input)
        local delta = input.Position - dragStart
        painelFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end

    titulo.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = painelFrame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch) then
            update(input)
        end
    end)

    -- Eventos
    caixaSize.FocusLost:Connect(function()
        local n = tonumber(caixaSize.Text)
        if n then
            tamanhoHitbox = math.clamp(n,1,100)
            if ativo then hitbox() end
        end
    end)

    botao.MouseButton1Click:Connect(function()
        ativo = not ativo
        botao.Text = ativo and "ATIVADO" or "DESATIVADO"
        botao.BackgroundColor3 = ativo and Color3.fromRGB(50,200,50) or Color3.fromRGB(200,50,50)
        hitbox()
    end)
end

criarPainel()
