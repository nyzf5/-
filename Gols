-- PAINEL DE CONTROLE HITBOX - VERS√ÉO FINAL COM ARRASTE FUNCIONAL
if not game:IsLoaded() then game.Loaded:Wait() end

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Vari√°veis
local ativo = false
local torsoOriginal
local tamanhoHitbox = 15
local arrastando = false
local offsetMouse = nil
local painelFrame

-- =========== ANIMA√á√ÉO FADE ===========
local function fadeInOut(texto, duracaoFade)
    local gui = Instance.new("ScreenGui")
    gui.Name = "AvisoFade"
    gui.Parent = player:WaitForChild("PlayerGui")
    gui.ResetOnSpawn = false
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0.8, 0, 0.08, 0)
    frame.Position = UDim2.new(0.1, 0, 0.9, 0)
    frame.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
    frame.BackgroundTransparency = 1
    frame.BorderSizePixel = 0
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.Text = texto
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.BackgroundTransparency = 1
    label.TextScaled = true
    label.Font = Enum.Font.GothamMedium
    
    label.Parent = frame
    frame.Parent = gui
    
    local fadeIn = TweenService:Create(frame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        BackgroundTransparency = 0.3
    })
    
    local fadeOut = TweenService:Create(frame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
        BackgroundTransparency = 1
    })
    
    fadeIn:Play()
    wait(duracaoFade)
    fadeOut:Play()
    
    fadeOut.Completed:Connect(function()
        wait(0.5)
        gui:Destroy()
    end)
end

-- =========== MOSTRAR AVISOS SEQUENCIAIS ===========
local function mostrarAvisosSequenciais()
    wait(1)
    fadeInOut("Dica üí°: use no 15 para ter melhor experi√™ncia ou pra nao acontecer bugs", 3)
    
    wait(4)
    fadeInOut("Avisos üö®: o script ainda est√° em desenvolvimento, ent√£o pode haver umas falhas.", 3)
end

-- =========== FUN√á√ÉO HITBOX ===========
local function hitbox()
    local torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
    if not torso then return end
    
    for _, conn in pairs(getconnections(torso.Touched)) do
        conn:Disconnect()
    end
    
    if ativo then
        if not torsoOriginal then
            torsoOriginal = torso.Size
        end
        
        -- COR ANTIGA: 0.7 de transpar√™ncia (70% transparente)
        torso.Size = Vector3.new(tamanhoHitbox, tamanhoHitbox, tamanhoHitbox)
        torso.Transparency = 0.7 -- COR ORIGINAL
        torso.Color = Color3.fromRGB(255, 0, 0)
        
        -- Detec√ß√£o de toque
        torso.Touched:Connect(function(hit)
            if not ativo then return end
            
            local nome = hit.Name:lower()
            local isBola = nome:find("ball") or nome:find("bola") or nome:find("soccer") or nome:find("futebol")
            
            if not isBola and hit.Parent then
                local nomeParent = hit.Parent.Name:lower()
                isBola = nomeParent:find("ball") or nomeParent:find("bola") or nomeParent:find("soccer")
            end
            
            if isBola then
                -- Calcular dire√ß√£o do chute
                local direcaoChute = (hit.Position - torso.Position).Unit
                
                -- Ajustar altura e for√ßa
                local chuteVertical = 0.5
                local chuteHorizontal = 0.8
                
                local direcaoFinal = Vector3.new(
                    direcaoChute.X * chuteHorizontal,
                    chuteVertical,
                    direcaoChute.Z * chuteHorizontal
                ).Unit * 100
                
                -- Aplicar for√ßa
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.Velocity = direcaoFinal
                bodyVelocity.MaxForce = Vector3.new(10000, 10000, 10000)
                
                local velAntiga = hit:FindFirstChild("BodyVelocity")
                if velAntiga then velAntiga:Destroy() end
                
                bodyVelocity.Parent = hit
                
                -- Efeito visual
                torso.Color = Color3.fromRGB(255, 255, 0)
                
                -- Som
                local som = Instance.new("Sound")
                som.SoundId = "rbxassetid://3570570104"
                som.Volume = 0.6
                som.Parent = hit
                som:Play()
                
                -- Efeito na bola
                local sparkles = Instance.new("Sparkles")
                sparkles.Color = ColorSequence.new(Color3.fromRGB(255, 255, 0))
                sparkles.Parent = hit
                
                -- Limpar
                game:GetService("Debris"):AddItem(bodyVelocity, 0.3)
                game:GetService("Debris"):AddItem(sparkles, 0.5)
                game:GetService("Debris"):AddItem(som, 2)
                
                -- Voltar cor original
                delay(0.1, function()
                    if torso and torso.Parent then
                        torso.Color = Color3.fromRGB(255, 0, 0)
                    end
                end)
            end
        end)
        
        print("‚úÖ Hitbox ativado - Tamanho: " .. tamanhoHitbox)
        
    else
        if torso and torsoOriginal then
            torso.Size = torsoOriginal
            torso.Transparency = 0
            torso.Color = Color3.fromRGB(255, 255, 255)
        end
        
        print("‚ùå Hitbox desativado")
    end
end

-- =========== CRIAR PAINEL ===========
local function criarPainel()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "PainelHitbox"
    screenGui.Parent = player:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    
    -- Painel principal
    painelFrame = Instance.new("Frame")
    painelFrame.Name = "Painel"
    painelFrame.Size = UDim2.new(0, 200, 0, 240)
    painelFrame.Position = UDim2.new(0, 20, 0.5, -120)
    painelFrame.AnchorPoint = Vector2.new(0, 0.5)
    painelFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    painelFrame.BackgroundTransparency = 0.21
    painelFrame.BorderSizePixel = 0
    
    -- Arredondar bordas
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = painelFrame
    
    -- Borda
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(100, 100, 100)
    stroke.Thickness = 2
    stroke.Parent = painelFrame
    
    -- T√≠tulo "HITBOX" (√ÅREA DE ARRASTE)
    local titulo = Instance.new("TextLabel")
    titulo.Name = "Titulo"
    titulo.Size = UDim2.new(1, 0, 0, 40)
    titulo.Position = UDim2.new(0, 0, 0, 10)
    titulo.Text = "HITBOX"
    titulo.TextColor3 = Color3.fromRGB(255, 255, 255)
    titulo.BackgroundTransparency = 1
    titulo.TextScaled = true
    titulo.Font = Enum.Font.GothamBold
    titulo.Active = true
    titulo.Selectable = true
    titulo.Parent = painelFrame
    
    -- Linha divis√≥ria
    local linha = Instance.new("Frame")
    linha.Size = UDim2.new(0.9, 0, 0, 2)
    linha.Position = UDim2.new(0.05, 0, 0, 55)
    linha.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    linha.BorderSizePixel = 0
    linha.Parent = painelFrame
    
    -- Cr√©dito "feito por Nyz"
    local credito = Instance.new("TextLabel")
    credito.Name = "Credito"
    credito.Size = UDim2.new(1, 0, 0, 15)
    credito.Position = UDim2.new(0, 0, 0, 60)
    credito.Text = "feito por Nyz"
    credito.TextColor3 = Color3.fromRGB(150, 150, 150)
    credito.BackgroundTransparency = 1
    credito.TextSize = 11
    credito.Font = Enum.Font.Gotham
    credito.TextTransparency = 0.4
    credito.Parent = painelFrame
    
    -- Texto "Tamanho:"
    local textoSize = Instance.new("TextLabel")
    textoSize.Name = "TextoSize"
    textoSize.Size = UDim2.new(1, 0, 0, 30)
    textoSize.Position = UDim2.new(0, 0, 0, 85)
    textoSize.Text = "Tamanho:"
    textoSize.TextColor3 = Color3.fromRGB(200, 200, 200)
    textoSize.BackgroundTransparency = 1
    textoSize.TextScaled = true
    textoSize.Font = Enum.Font.Gotham
    textoSize.Parent = painelFrame
    
    -- Caixa para n√∫mero do tamanho
    local caixaSize = Instance.new("TextBox")
    caixaSize.Name = "CaixaSize"
    caixaSize.Size = UDim2.new(0.8, 0, 0, 35)
    caixaSize.Position = UDim2.new(0.1, 0, 0, 120)
    caixaSize.Text = tostring(tamanhoHitbox)
    caixaSize.TextColor3 = Color3.fromRGB(255, 255, 255)
    caixaSize.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    caixaSize.BackgroundTransparency = 0.3
    caixaSize.TextScaled = true
    caixaSize.Font = Enum.Font.Gotham
    caixaSize.PlaceholderText = "Recomendado: 15"
    caixaSize.Parent = painelFrame
    
    local cornerCaixa = Instance.new("UICorner")
    cornerCaixa.CornerRadius = UDim.new(0, 5)
    cornerCaixa.Parent = caixaSize
    
    -- Texto "Ativar:"
    local textoAtivar = Instance.new("TextLabel")
    textoAtivar.Name = "TextoAtivar"
    textoAtivar.Size = UDim2.new(1, 0, 0, 30)
    textoAtivar.Position = UDim2.new(0, 0, 0, 165)
    textoAtivar.Text = "Ativar:"
    textoAtivar.TextColor3 = Color3.fromRGB(200, 200, 200)
    textoAtivar.BackgroundTransparency = 1
    textoAtivar.TextScaled = true
    textoAtivar.Font = Enum.Font.Gotham
    textoAtivar.Parent = painelFrame
    
    -- Bot√£o Ativar/Desativar
    local botaoAtivar = Instance.new("TextButton")
    botaoAtivar.Name = "BotaoAtivar"
    botaoAtivar.Size = UDim2.new(0.8, 0, 0, 40)
    botaoAtivar.Position = UDim2.new(0.1, 0, 0, 195)
    botaoAtivar.Text = "DESATIVADO"
    botaoAtivar.TextColor3 = Color3.fromRGB(255, 255, 255)
    botaoAtivar.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    botaoAtivar.BackgroundTransparency = 0.2
    botaoAtivar.TextScaled = true
    botaoAtivar.Font = Enum.Font.GothamBold
    botaoAtivar.Parent = painelFrame
    
    local cornerBotao = Instance.new("UICorner")
    cornerBotao.CornerRadius = UDim.new(0, 8)
    cornerBotao.Parent = botaoAtivar
    
    -- =========== SISTEMA DE ARRASTE NO T√çTULO ===========
    titulo.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            arrastando = true
            offsetMouse = painelFrame.AbsolutePosition - input.Position
            painelFrame.BackgroundTransparency = 0.3
        end
    end)
    
    titulo.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            arrastando = false
            offsetMouse = nil
            painelFrame.BackgroundTransparency = 0.21
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if arrastando and offsetMouse then
            if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                local mousePos = input.Position
                local novaPos = UDim2.new(
                    0, mousePos.X + offsetMouse.X,
                    0, mousePos.Y + offsetMouse.Y
                )
                
                -- Limitar aos cantos da tela
                local telaSize = workspace.CurrentCamera.ViewportSize
                
                -- N√£o deixar sair pela esquerda
                if novaPos.X.Offset < 10 then
                    novaPos = UDim2.new(0, 10, novaPos.Y.Scale, novaPos.Y.Offset)
                end
                
                -- N√£o deixar sair pela direita
                if novaPos.X.Offset + painelFrame.AbsoluteSize.X > telaSize.X - 10 then
                    novaPos = UDim2.new(0, telaSize.X - painelFrame.AbsoluteSize.X - 10, novaPos.Y.Scale, novaPos.Y.Offset)
                end
                
                -- N√£o deixar sair por cima
                if novaPos.Y.Offset < 10 then
                    novaPos = UDim2.new(novaPos.X.Scale, novaPos.X.Offset, 0, 10)
                end
                
                -- N√£o deixar sair por baixo
                if novaPos.Y.Offset + painelFrame.AbsoluteSize.Y > telaSize.Y - 10 then
                    novaPos = UDim2.new(novaPos.X.Scale, novaPos.X.Offset, 0, telaSize.Y - painelFrame.AbsoluteSize.Y - 10)
                end
                
                -- Aplicar nova posi√ß√£o
                painelFrame.Position = novaPos
            end
        end
    end)
    
    -- =========== EVENTOS DOS CONTROLES ===========
    caixaSize.FocusLost:Connect(function()
        local novoNumero = tonumber(caixaSize.Text)
        if novoNumero and novoNumero >= 1 then
            tamanhoHitbox = math.clamp(novoNumero, 1, 100)
            caixaSize.Text = tostring(tamanhoHitbox)
            
            if ativo then
                hitbox()
                wait(0.1)
                hitbox()
            end
        else
            caixaSize.Text = tostring(tamanhoHitbox)
        end
    end)
    
    botaoAtivar.MouseButton1Click:Connect(function()
        ativo = not ativo
        
        if ativo then
            botaoAtivar.Text = "ATIVADO"
            botaoAtivar.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        else
            botaoAtivar.Text = "DESATIVADO"
            botaoAtivar.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        end
        
        hitbox()
    end)
    
    painelFrame.Parent = screenGui
    return screenGui
end

-- =========== INICIALIZAR ===========
local painelGui = criarPainel()
spawn(mostrarAvisosSequenciais)

player.CharacterAdded:Connect(function(novoChar)
    character = novoChar
    torsoOriginal = nil
    
    if ativo then
        ativo = false
        
        local botao = painelGui:FindFirstChild("Painel") and painelGui.Painel:FindFirstChild("BotaoAtivar")
        if botao then
            botao.Text = "DESATIVADO"
            botao.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        end
    end
end)

-- Aviso sobre arraste
local avisoArraste = Instance.new("ScreenGui", player.PlayerGui)
local textoArraste = Instance.new("TextLabel", avisoArraste)
textoArraste.Size = UDim2.new(0.8, 0, 0.07, 0)
textoArraste.Position = UDim2.new(0.1, 0, 0.8, 0)
textoArraste.Text = "üñ±Ô∏è Segure e arraste o texto 'HITBOX' para mover o painel"
textoArraste.TextColor3 = Color3.fromRGB(255, 255, 255)
textoArraste.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
textoArraste.BackgroundTransparency = 0.5
textoArraste.TextScaled = true
textoArraste.Visible = true

delay(5, function()
    textoArraste.Visible = false
end)

print("==========================================")
print("üéØ HITBOX - PROJETO FINALIZADO!")
print("==========================================")
print("‚Ä¢ Arraste: SEGURE o texto 'HITBOX' para mover")
print("‚Ä¢ Feedback visual: Painel fica menos transparente ao arrastar")
print("‚Ä¢ Cor original: Vermelho 70% transparente")
print("‚Ä¢ Tamanho padr√£o: 15")
print("‚Ä¢ Avisos com fade in/out")
print("‚Ä¢ feito por Nyz")
print("==========================================")
